zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: ad01c1e8adba4363bb716d6c4d7492e8
      name: Templates/Appliances
  templates:
    - uuid: b1f33b2f27524aeba51e79c749ca03cd
      template: 'Symantec SMG Virtual Appliance by SNMP'
      name: 'Symantec SMG Virtual Appliance by SNMP'
      groups:
        - name: Templates/Appliances
      items:
        - uuid: 6a036719456d4726b108eb2791729c59
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          history: 1w
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 3f7ac9a0aff94ea386b435157faea289
              expression: 'max(/Symantec SMG Virtual Appliance by SNMP/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: DISASTER
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
        - uuid: 7d7b3e13df154efaaa2665bb91919fdc
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: c74e14bb849f40e88fd987acff591b23
              expression: 'min(/Symantec SMG Virtual Appliance by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Symantec SMG Virtual Appliance by SNMP/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Symantec SMG Virtual Appliance by SNMP/icmpping,#3)=0'
        - uuid: d47839a5447f4bd3806326552f2b95a0
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 7eb6440fdca248179eb7a81a5f44b2ca
              expression: 'avg(/Symantec SMG Virtual Appliance by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: 'High ICMP ping loss'
                  expression: 'min(/Symantec SMG Virtual Appliance by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Symantec SMG Virtual Appliance by SNMP/icmppingloss,5m)<100'
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Symantec SMG Virtual Appliance by SNMP/icmpping,#3)=0'
        - uuid: ed7335529cf54c508bdb7e2c5544ff08
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 1h
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Application
              value: General
        - uuid: 64866918f8e14006b85ba6de7d509567
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: system.descr
          delay: 1h
          history: 7d
          value_type: TEXT
          trends: '0'
          tags:
            - tag: component
              value: system
        - uuid: 78447bee67de4aa59f9ea211e7e3f52b
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 1h
          history: 2w
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: Application
              value: General
        - uuid: d1a052b48e5f405dbb8923adb2ab77d8
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          history: 7d
          value_type: TEXT
          trends: '0'
          tags:
            - tag: component
              value: system
        - uuid: b6af8b21a91e4567a728d8a686736c54
          name: 'System uptime'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: system.uptime
          delay: 5m
          history: 7d
          value_type: FLOAT
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: f61780f48cc248379dc8b38c1b13f417
          name: Uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 6ac4a9b981434943b70bca961376bd83
              expression: 'last(/Symantec SMG Virtual Appliance by SNMP/system.uptime[sysUpTime.0])<10m'
              name: '{HOST.NAME} has been restarted (uptime < 10m)'
              priority: HIGH
              description: 'Uptime is less than 10 minutes'
              manual_close: 'YES'
              dependencies:
                - name: 'No SNMP data collection'
                  expression: 'max(/Symantec SMG Virtual Appliance by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
        - uuid: 68b9d0f7dca24559b6efb3e3342f5ed8
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          tags:
            - tag: Application
              value: Status
          triggers:
            - uuid: 14b0afef94d0474dab6a38c04db240a0
              expression: 'max(/Symantec SMG Virtual Appliance by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: DISASTER
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'Unavailable by ICMP ping'
                  expression: 'max(/Symantec SMG Virtual Appliance by SNMP/icmpping,#3)=0'
      discovery_rules:
        - uuid: 0e18788b65f94854a3cf03422176643b
          name: 'SMG MTA instance discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SMG.INDEX},1.3.6.1.4.1.393.200.130.2.2.1.1.1,{#SMG.INSTANCE},1.3.6.1.4.1.393.200.130.2.2.1.1.2]'
          key: smg.mta.discovery
          delay: 1h
          description: 'Discovers MTA instances running on the SMG appliance.'
          item_prototypes:
            - uuid: ca717bb1c9564841a69c8d942840c465
              name: '{#SMG.INSTANCE}: Connections'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.3.{#SMG.INDEX}'
              key: 'smg.mta.connections[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
            - uuid: 9035d16fd94d4c63b31eb0bc19350018
              name: '{#SMG.INSTANCE}: Data rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.4.{#SMG.INDEX}'
              key: 'smg.mta.datarate[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
            - uuid: 8da94a55d1794fc7ae1ad9d07ee78829
              name: '{#SMG.INSTANCE}: Deferred messages'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.5.{#SMG.INDEX}'
              key: 'smg.mta.deferred[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
            - uuid: 62187aafa4644f15818981573442877a
              name: '{#SMG.INSTANCE}: Description'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.2.{#SMG.INDEX}'
              key: 'smg.mta.descr[{#SMG.INDEX}]'
              delay: 10m
              history: 30d
              value_type: TEXT
              trends: '0'
              tags:
                - tag: component
                  value: mta
            - uuid: 8169b5f667b24f4e98a2719f986f4858
              name: '{#SMG.INSTANCE}: Message rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.6.{#SMG.INDEX}'
              key: 'smg.mta.messagerate[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
            - uuid: b62a75138ab0422baaedef39274a4263
              name: '{#SMG.INSTANCE}: Queued messages'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.8.{#SMG.INDEX}'
              key: 'smg.mta.queued[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
            - uuid: 0bebc7d8b3344291909091bdb6765033
              name: '{#SMG.INSTANCE}: Queue size'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.393.200.130.2.2.1.1.7.{#SMG.INDEX}'
              key: 'smg.mta.queuesize[{#SMG.INDEX}]'
              history: 30d
              tags:
                - tag: component
                  value: mta
      macros:
        - macro: '{$SNMP_COMMUNITY}'
          value: public
          description: 'SNMP community (for SNMPv2c)'
        - macro: '{$SNMP_PORT}'
          value: '161'
          description: 'SNMP port'
      valuemaps:
        - uuid: f7afd049f6d84b9e8b1c820121f4150f
          name: 'Symantec SMG pass/fail status'
          mappings:
            - value: '1'
              newvalue: pass
            - value: '2'
              newvalue: fail
            - value: '3'
              newvalue: unknown
            - value: '4'
              newvalue: unavailable
        - uuid: 98bb151cb6d44908840825a22e8e94fe
          name: 'Symantec SMG redundancy status'
          mappings:
            - value: '1'
              newvalue: fullyRedundant
            - value: '2'
              newvalue: redundancyLost
            - value: '3'
              newvalue: redundancyUnknown
